<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChetGPT Command Board</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f0f23; color: #e4e4e7; min-height: 100vh; padding: 20px;
        }
        .container { max-width: 1600px; margin: 0 auto; }
        header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #27272a;
        }
        h1 { font-size: 24px; font-weight: 600; color: #f4f4f5; }
        .header-actions { display: flex; gap: 10px; align-items: center; }
        #taskInput {
            padding: 10px 16px; font-size: 14px; border: 1px solid #3f3f46;
            border-radius: 8px; background: #18181b; color: #e4e4e7; width: 280px; outline: none;
        }
        #taskInput:focus { border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99,102,241,0.2); }
        .btn {
            padding: 10px 20px; font-size: 14px; font-weight: 500; border: none;
            border-radius: 8px; cursor: pointer; transition: all 0.2s;
        }
        .btn-primary { background: #6366f1; color: white; }
        .btn-primary:hover { background: #4f46e5; }
        .btn-sync { background: #059669; color: white; font-size: 12px; padding: 8px 14px; }
        .btn-sync:hover { background: #047857; }
        .stats-bar {
            display: flex; justify-content: center; gap: 25px; padding: 10px 20px;
            background: #18181b; border-radius: 8px; border: 1px solid #27272a; margin-bottom: 20px;
        }
        .stat-item { display: flex; align-items: center; gap: 6px; font-size: 13px; color: #a1a1aa; }
        .stat-value { font-weight: 600; color: #e4e4e7; }
        .stat-label { font-size: 12px; color: #71717a; }
        .board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        .column {
            background: #18181b; border-radius: 12px; padding: 16px;
            min-height: 400px; border: 1px solid #27272a;
        }
        .column-header {
            display: flex; align-items: center; gap: 8px; margin-bottom: 16px;
            padding-bottom: 12px; border-bottom: 1px solid #27272a;
        }
        .column-icon { width: 10px; height: 10px; border-radius: 50%; }
        .column-title { font-size: 14px; font-weight: 600; flex: 1; }
        .task-count {
            font-size: 12px; color: #71717a; background: #27272a;
            padding: 3px 8px; border-radius: 10px;
        }
        .backlog .column-icon { background: #f59e0b; }
        .in-progress .column-icon { background: #3b82f6; }
        .chet-active .column-icon { background: #a855f7; animation: pulse 2s infinite; }
        .done .column-icon { background: #22c55e; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
        .tasks { display: flex; flex-direction: column; gap: 10px; min-height: 300px; }
        .task {
            background: #27272a; border-radius: 8px; padding: 12px 14px; cursor: grab;
            position: relative; transition: all 0.2s; border: 1px solid transparent;
        }
        .task:hover { background: #3f3f46; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .task.dragging { opacity: 0.5; }
        .task.chet-task { border-left: 3px solid #a855f7; }
        .task.personal-task { border-left: 3px solid #3b82f6; }
        .task-text { font-size: 13px; line-height: 1.4; word-break: break-word; padding-right: 20px; }
        .task-tag {
            display: inline-block; font-size: 10px; padding: 2px 6px; border-radius: 4px;
            margin-top: 6px; font-weight: 500;
        }
        .tag-chet { background: #581c87; color: #d8b4fe; }
        .tag-personal { background: #1e3a5f; color: #93c5fd; }
        .tag-setup { background: #1c4532; color: #86efac; }
        .tag-scraping { background: #713f12; color: #fde047; }
        .tag-research { background: #4c1d95; color: #c4b5fd; }
        .delete-btn {
            position: absolute; top: 6px; right: 6px; width: 22px; height: 22px;
            border: none; background: transparent; color: #71717a; cursor: pointer;
            border-radius: 4px; font-size: 16px; opacity: 0; transition: all 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        .task:hover .delete-btn { opacity: 1; }
        .delete-btn:hover { background: #ef4444; color: white; }
        .task-meta { margin-top: 6px; font-size: 11px; color: #52525b; }
        .empty-state { text-align: center; padding: 30px 15px; color: #52525b; font-size: 13px; }
        .last-sync { font-size: 11px; color: #52525b; }
        @media (max-width: 1200px) { .board { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 700px) {
            .board { grid-template-columns: 1fr; }
            header { flex-direction: column; gap: 15px; }
            #taskInput { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>âš¡ ChetGPT Command Board</h1>
                <span class="last-sync" id="lastSync">Last sync: --</span>
            </div>
            <div class="header-actions">
                <input type="text" id="taskInput" placeholder="Add a task..." maxlength="200">
                <button class="btn btn-primary" id="addBtn">Add</button>
                <button class="btn btn-sync" id="syncBtn">ðŸ”„ Sync</button>
            </div>
        </header>
        <div class="stats-bar" id="statsBar">
            <div class="stat-item"><span class="stat-label">Today:</span><span class="stat-value" id="todaySpend">$0.00</span></div>
            <div class="stat-item"><span class="stat-label">Week:</span><span class="stat-value" id="weekSpend">$0.00</span></div>
            <div class="stat-item"><span class="stat-label">Avg:</span><span class="stat-value" id="dailyAvg">$0.00/day</span></div>
            <div class="stat-item"><span class="stat-label">Top:</span><span class="stat-value" id="topModel">--</span></div>
        </div>
        <div class="board">
            <div class="column backlog" data-column="backlog">
                <div class="column-header">
                    <div class="column-icon"></div>
                    <span class="column-title">ðŸ“‹ Backlog</span>
                    <span class="task-count" id="backlog-count">0</span>
                </div>
                <div class="tasks" id="backlog"></div>
            </div>
            <div class="column in-progress" data-column="inProgress">
                <div class="column-header">
                    <div class="column-icon"></div>
                    <span class="column-title">ðŸ”¥ In Progress</span>
                    <span class="task-count" id="inProgress-count">0</span>
                </div>
                <div class="tasks" id="inProgress"></div>
            </div>
            <div class="column chet-active" data-column="chetActive">
                <div class="column-header">
                    <div class="column-icon"></div>
                    <span class="column-title">ðŸ¤– ChetGPT Active</span>
                    <span class="task-count" id="chetActive-count">0</span>
                </div>
                <div class="tasks" id="chetActive"></div>
            </div>
            <div class="column done" data-column="done">
                <div class="column-header">
                    <div class="column-icon"></div>
                    <span class="column-title">âœ… Done</span>
                    <span class="task-count" id="done-count">0</span>
                </div>
                <div class="tasks" id="done"></div>
            </div>
        </div>
    </div>
    <script>
        const STORAGE_KEY = 'kanban_tasks_v2';
        let tasks = [];
        let draggedTask = null;

        // ============================================================
        // CHET_TASKS: ChetGPT updates this section programmatically
        // Each task has: id, text, column, tag, source
        // Columns: backlog, inProgress, chetActive, done
        // Tags: chet, personal, setup, scraping, research
        // ============================================================
        const CHET_TASKS = [
            // === PERSONAL TASKS (from TickTick) ===
            { id: 'p1', text: 'Dov RosenFeld - Canada Shipment MUST SEND', column: 'inProgress', tag: 'personal', source: 'aviel' },
            { id: 'p2', text: 'Eva birthday - Plan it ðŸŽ‚', column: 'inProgress', tag: 'personal', source: 'aviel' },
            { id: 'p3', text: 'Call UPS to Dispute Charges', column: 'inProgress', tag: 'personal', source: 'aviel' },
            { id: 'p4', text: 'Showerhead - ORDER from Home Depot', column: 'inProgress', tag: 'personal', source: 'aviel' },
            { id: 'p5', text: 'Pay HLSF website payments', column: 'inProgress', tag: 'personal', source: 'aviel' },
            { id: 'p6', text: 'DIVERSIFIED: Call about tax on last invoice', column: 'backlog', tag: 'personal', source: 'aviel' },
            { id: 'p7', text: 'HEALTH INSURANCE: Call to change', column: 'backlog', tag: 'personal', source: 'aviel' },
            { id: 'p8', text: 'Make reservations with Daniel and Hanna', column: 'backlog', tag: 'personal', source: 'aviel' },
            { id: 'p9', text: 'Kids tuition', column: 'backlog', tag: 'personal', source: 'aviel' },
            { id: 'p10', text: 'Call MariePopShop - partnership', column: 'backlog', tag: 'personal', source: 'aviel' },
            // === CHETGPT ACTIVE TASKS ===
            { id: 'c1', text: 'ðŸ” Verifying session memory search is enabled', column: 'chetActive', tag: 'setup', source: 'chet' },
            // === THIS WEEK (from Alex Finn analysis) ===
            { id: 'c13', text: 'ðŸ§  Deeper brain dump â€” routines, values, relationships, life goals', column: 'inProgress', tag: 'setup', source: 'chet' },
            { id: 'c14', text: 'ðŸ”„ Reverse prompting session â€” unlock proactive behavior', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c15', text: 'ðŸ’» Install Codex CLI as coding muscle (free via GPT-5.2)', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c16', text: 'ðŸ› ï¸ Build custom pricing calculator skill', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c17', text: 'ðŸ› ï¸ Build custom invoice extractor skill', column: 'backlog', tag: 'setup', source: 'chet' },
            // === NEXT 2 WEEKS ===
            { id: 'c18', text: 'ðŸ’¬ Set up Discord as multi-agent workspace', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c19', text: 'ðŸ“Š Afternoon research report (printing industry trends)', column: 'backlog', tag: 'research', source: 'chet' },
            { id: 'c20', text: 'ðŸ› ï¸ Build customer quote generator skill', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c21', text: 'ðŸ› ï¸ Build paper stock lookup skill', column: 'backlog', tag: 'setup', source: 'chet' },
            // === SCRAPING ===
            { id: 'c4', text: 'Complete 5x7 NDF postcard scrape (qty 2000-5000 + double-sided)', column: 'backlog', tag: 'scraping', source: 'chet' },
            { id: 'c5', text: 'Scrape 4x6 NDF postcards (single + double sided)', column: 'backlog', tag: 'scraping', source: 'chet' },
            { id: 'c6', text: 'Scrape 6x9 NDF postcards (single + double sided)', column: 'backlog', tag: 'scraping', source: 'chet' },
            { id: 'c7', text: 'Find NDF internal pricing API (bypass slow browser)', column: 'backlog', tag: 'research', source: 'chet' },
            // === SETUP ===
            { id: 'c8', text: 'Fund DeepSeek API ($5 at platform.deepseek.com)', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c9', text: 'Configure memory search (needs embedding provider)', column: 'backlog', tag: 'setup', source: 'chet' },
            { id: 'c12', text: 'Install jq + ripgrep for session-logs skill', column: 'backlog', tag: 'setup', source: 'chet' },
            // === DONE ===
            { id: 'd1', text: 'âœ… Upgraded to Opus 4.6', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd2', text: 'âœ… Confirmed GPT-5.2 working (Codex OAuth)', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd3', text: 'âœ… Configured Brave Search API', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd4', text: 'âœ… Installed YouTube transcript tool', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd5', text: 'âœ… Pulled 11 Alex Finn transcripts (55,903 words)', column: 'done', tag: 'research', source: 'chet' },
            { id: 'd6', text: 'âœ… Removed broken gpt-4o-codex model', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd7', text: 'âœ… Updated OpenClaw to 2026.2.9', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd8', text: 'âœ… Set up morning brief cron (8AM Mon-Fri)', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd9', text: 'âœ… Built Kanban board + cost tracking', column: 'done', tag: 'setup', source: 'chet' },
            { id: 'd10', text: 'âœ… 5x7 postcards partial scrape (qty 25-1000)', column: 'done', tag: 'scraping', source: 'chet' },
            { id: 'd11', text: 'âœ… Analyzed 11 Alex Finn transcripts (55,903 words)', column: 'done', tag: 'research', source: 'chet' },
            { id: 'd12', text: 'âœ… Extracted action items from all transcripts', column: 'done', tag: 'research', source: 'chet' },
            { id: 'd13', text: 'âœ… YouTube transcript tool installed', column: 'done', tag: 'setup', source: 'chet' },
        ];
        // SYNC_TIMESTAMP: 2026-02-12T12:20:00Z
        // ============================================================

        document.addEventListener('DOMContentLoaded', () => {
            syncTasks();
            loadTasks();
            renderTasks();
            setupEventListeners();
            updateSyncTime();
        });

        function syncTasks() {
            const stored = localStorage.getItem(STORAGE_KEY);
            let existing = [];
            if (stored) {
                try { existing = JSON.parse(stored); } catch(e) { existing = []; }
            }
            // Merge: CHET_TASKS are source of truth for chet tasks
            // Personal tasks from localStorage are preserved if user moved them
            const chetIds = new Set(CHET_TASKS.map(t => t.id));
            const userMoved = {};
            existing.forEach(t => {
                if (chetIds.has(t.id) && t._userMoved) {
                    userMoved[t.id] = t.column;
                }
            });
            // Keep user-added tasks (not in CHET_TASKS)
            const userTasks = existing.filter(t => !chetIds.has(t.id));
            // Build final list
            const merged = CHET_TASKS.map(t => ({
                ...t,
                column: userMoved[t.id] || t.column,
                _userMoved: !!userMoved[t.id],
                createdAt: t.createdAt || new Date().toISOString()
            }));
            tasks = [...merged, ...userTasks];
            localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
        }

        function updateSyncTime() {
            const match = document.body.innerHTML.match(/SYNC_TIMESTAMP:\s*([^\n<]+)/);
            if (match) {
                const d = new Date(match[1].trim());
                document.getElementById('lastSync').textContent = 'Last sync: ' + d.toLocaleString();
            }
        }

        function loadTasks() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) { try { tasks = JSON.parse(stored); } catch(e) { tasks = []; } }
        }

        function saveTasks() { localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)); }
        function generateId() { return 'u' + Date.now().toString(36) + Math.random().toString(36).substr(2); }

        function addTask(text) {
            const trimmed = text.trim();
            if (!trimmed) return;
            tasks.push({ id: generateId(), text: trimmed, column: 'backlog', tag: 'personal', source: 'aviel', createdAt: new Date().toISOString() });
            saveTasks(); renderTasks();
        }

        function deleteTask(id) { tasks = tasks.filter(t => t.id !== id); saveTasks(); renderTasks(); }

        function moveTask(id, newColumn) {
            const task = tasks.find(t => t.id === id);
            if (task) { task.column = newColumn; task._userMoved = true; saveTasks(); renderTasks(); }
        }

        function renderTasks() {
            const columns = {
                backlog: document.getElementById('backlog'),
                inProgress: document.getElementById('inProgress'),
                chetActive: document.getElementById('chetActive'),
                done: document.getElementById('done')
            };
            Object.values(columns).forEach(col => col.innerHTML = '');
            const counts = { backlog: 0, inProgress: 0, chetActive: 0, done: 0 };
            tasks.forEach(task => {
                if (!columns[task.column]) return;
                counts[task.column]++;
                columns[task.column].appendChild(createTaskElement(task));
            });
            ['backlog','inProgress','chetActive','done'].forEach(key => {
                document.getElementById(key + '-count').textContent = counts[key];
                if (counts[key] === 0) columns[key].innerHTML = '<div class="empty-state">No tasks</div>';
            });
        }

        function createTaskElement(task) {
            const el = document.createElement('div');
            el.className = 'task ' + (task.source === 'chet' ? 'chet-task' : 'personal-task');
            el.draggable = true;
            el.dataset.id = task.id;
            const tagClass = 'tag-' + (task.tag || 'personal');
            const tagLabel = task.tag || 'personal';
            const sourceIcon = task.source === 'chet' ? 'ðŸ¤–' : 'ðŸ‘¤';
            el.innerHTML = `
                <span class="task-text">${escapeHtml(task.text)}</span>
                <button class="delete-btn" title="Delete">Ã—</button>
                <div class="task-meta">
                    ${sourceIcon} <span class="task-tag ${tagClass}">${tagLabel}</span>
                </div>
            `;
            el.querySelector('.delete-btn').addEventListener('click', e => { e.stopPropagation(); deleteTask(task.id); });
            el.addEventListener('dragstart', function(e) { draggedTask = this; this.classList.add('dragging'); e.dataTransfer.setData('text/plain', this.dataset.id); });
            el.addEventListener('dragend', function() { this.classList.remove('dragging'); draggedTask = null; });
            return el;
        }

        function escapeHtml(t) { const d = document.createElement('div'); d.textContent = t; return d.innerHTML; }

        function setupEventListeners() {
            document.getElementById('addBtn').addEventListener('click', () => {
                const input = document.getElementById('taskInput');
                addTask(input.value); input.value = ''; input.focus();
            });
            document.getElementById('taskInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') { addTask(e.target.value); e.target.value = ''; }
            });
            document.getElementById('syncBtn').addEventListener('click', () => {
                localStorage.removeItem(STORAGE_KEY);
                syncTasks(); loadTasks(); renderTasks();
                alert('Synced with ChetGPT updates!');
            });
            document.querySelectorAll('.tasks').forEach(column => {
                column.addEventListener('dragover', e => {
                    e.preventDefault();
                    const afterEl = getDragAfterElement(column, e.clientY);
                    const draggable = document.querySelector('.dragging');
                    if (!draggable) return;
                    if (!afterEl) column.appendChild(draggable);
                    else column.insertBefore(draggable, afterEl);
                });
                column.addEventListener('drop', e => {
                    e.preventDefault();
                    const taskId = e.dataTransfer.getData('text/plain');
                    moveTask(taskId, column.id);
                });
            });
        }

        function getDragAfterElement(container, y) {
            const els = [...container.querySelectorAll('.task:not(.dragging)')];
            return els.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) return { offset, element: child };
                return closest;
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
    </script>
</body>
</html>
